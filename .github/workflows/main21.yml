name: Store Hashtable as Environment Variable

on:
  push:
    branches:
      - main

jobs:
  store_hashtable:
    runs-on: ubuntu-latest

    steps:
    - name: Set Hashtable as Environment Variable
      run: |
        $myHashtable = @{
          key1 = 'value1'
          key2 = 'value2'
        }
        $myHashtableJson = $myHashtable | ConvertTo-Json
        echo "MY_HASHTABLE=$myHashtableJson" >> $GITHUB_ENV

  use_hashtable:
    runs-on: ubuntu-latest

    steps:
    - name: Use Hashtable from Environment Variable
      run: |
        $myHashtableJson = $env:MY_HASHTABLE
        $myHashtable = $myHashtableJson | ConvertFrom-Json
        Write-Host "Hashtable key1: $($myHashtable.key1)"
        Write-Host "Hashtable key2: $($myHashtable.key2)"
