name: Set JSON as Variable1 (Windows)

on:
  push:
    branches:
      - main

jobs:
  set_json_variable:
    runs-on: windows-latest

    steps:
    - name: Set JSON as Variable
      id: set-json
      shell: powershell
      run: |
        # Your JSON string here
        $jsonString = '{"key1": "value1", "key2": "value2"}'
        echo "##vso[task.setvariable variable=my_json;isOutput=true]$jsonString"

  use_json_variable:
    runs-on: windows-latest

    steps:
    - name: Use JSON Variable
      shell: powershell
      run: |
        # Access the JSON variable from the previous step
        $myJson = $env:my_json
        Write-Host "JSON variable value: $myJson"

    - name: Parse JSON
      shell: powershell
      run: |
        # Parse the JSON variable
        $jsonObject = $myJson | ConvertFrom-Json
        Write-Host "Parsed JSON object:"
        $jsonObject | Format-Table -AutoSize
